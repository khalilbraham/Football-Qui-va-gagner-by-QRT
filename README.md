# Football Match Outcome Prediction Framework

## Overview
This project aims to develop a framework capable of predicting the final score of football matches by processing and linking team and player statistics. The project employs various machine learning and deep learning models to achieve this goal.

## Table of Contents
1. [Introduction](#introduction)
2. [Data Exploration](#data-exploration)
3. [Data Cleaning](#data-cleaning)
4. [Variable Selection](#variable-selection)
5. [Data Modeling Approaches](#data-modeling-approaches)
6. [Ensemble Learning](#ensemble-learning)
7. [Future Improvements](#future-improvements)
8. [Conclusion](#conclusion)

## Introduction
In this challenge, the goal is to build a framework that processes and links statistics of competing teams and players to predict the final match score. Various modeling approaches are tested to train machine learning and deep learning models effectively. The primary challenge is creating a shared space that associates both player and team data to reveal informative metrics for prediction.

## Data Exploration
The dataset consists of two subsets (train and test data). Each subset contains occurrences corresponding to different matches identified by a unique match ID that links the team and player data with their results.

### Data Subsets Sizes
- **Train Data**:
  - Teams: 12,303 matches
  - Players: 237,079 home and 236,132 away
- **Test Data**:
  - Teams: 25,368 matches
  - Players: 509,816 home and 504,626 away

## Data Cleaning
### Handling Missing Data
- **Team Data**:
  - Missing values: 82,407 for home teams and 82,495 for away teams.
  - Aggregated data by team using cumulative variables such as TEAM_SHOTS_TOTAL_season_sum and TEAM_SHOTS_INSIDEBOX_season_sum.

### Building a Starting Eleven for Each Team
- A strategy was devised to form a typical team by identifying the top eleven players for each position based on specific criteria, improving the structuring of input data.

## Variable Selection
Mutual Information (MI) score was adopted for selecting variables in the context of classification. MI measures the shared information between two variables, assessing each team's statistics' relevance to the match outcome.

## Data Modeling Approaches
### Performance Ratio Normalization
Data was normalized by calculating the performance ratio between home and away teams and players. This method facilitates classification algorithms and enhances decision thresholds for boosting methods.

### Graphical Modeling of Player Interactivity
Constructed a network representation of players within a team, where nodes represent players and edges represent interactions based on various interactivity indicators.

#### Graph Construction
- Each player’s match data, including positions and interaction statistics, is used to form graphs representing team dynamics.
- Interactions (edges) between players are determined based on their positions and specific statistical criteria.

### Model Architecture
#### Graph Convolutional Networks (GCN)
GCNs extend convolutional neural networks to graph data, learning graph representations by considering local structures and node relationships.

#### Graph Attention Networks (GAT)
GATs introduce attention mechanisms to graph data, allowing the model to weigh node interactions differently based on their importance.

### CatBoost Model
The embeddings generated by the GAT model, capturing relational information among players, are used as input features for a CatBoost model designed for multi-class classification.

### Regression Models and Stacking
A cascading approach using regression models such as CatBoost, XGBoost, and LightGBM estimates residuals between initial predictions and actual labels. These residuals are added to the initial predictions for improved accuracy.

## Ensemble Learning
Weighted averaging of predictions from multiple models to enhance robustness and overall performance. Models are weighted based on their individual performance scores on validation or test datasets.

## Architecture

![image](https://github.com/khalilbraham/Football-Qui-va-gagner-by-QRT/assets/74321121/1b1cc93c-8f52-441e-8696-ff7373778102)


## Future Improvements
- **Temporal and Seasonal Interactions**: Incorporate features like season phase, recent team performance, and player composition changes over time.
- **Player Data Analysis**: Consider individual player performance, physical condition, injury history, and specific play styles for more accurate predictions.
- **Advanced Modeling Techniques**: Explore reinforcement learning and more complex neural networks for improved predictive capabilities.

## Conclusion
The framework successfully integrates team and player data using various modeling techniques to predict football match outcomes. While current results are promising, further improvements can be made by incorporating additional data dimensions and advanced modeling techniques.

---

By:  
Rayane Kimouche (ENS Paris Saclay)  
Mohamed Khalil Braham (Télécom Paris)

